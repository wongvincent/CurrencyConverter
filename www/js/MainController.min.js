angular.module("app").controller("MainController",["$scope","$http","$ionicLoading","$ionicPopup","localStorageService",function(e,n,t,a,l){function o(){e.currenciesModel={};for(var n in e.currencies)e.currenciesModel[n]=null}function i(e,n,t){var a=t/c[e];return a*c[n]}function s(e,n){var t=u(e,n);return 0===t?null:t}function u(e,n){return Number(Math.round(e+"e"+n)+"e-"+n)}function r(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}e.currencies={AUD:{show:!1,fullname:"Australian Dollar"},BGN:{show:!1,fullname:"Bulgarian Lev"},BRL:{show:!1,fullname:"Brazilian Real"},CAD:{show:!0,fullname:"Canadian Dollar"},CHF:{show:!1,fullname:"Swiss Franc"},CNY:{show:!0,fullname:"Chinese Yuan"},CZK:{show:!1,fullname:"Czech Koruna"},DKK:{show:!1,fullname:"Danish Krone"},EUR:{show:!0,fullname:"Euro"},GBP:{show:!0,fullname:"British Pound"},HKD:{show:!1,fullname:"Hong Kong Dollar"},HRK:{show:!1,fullname:"Croatian Kuna"},HUF:{show:!1,fullname:"Hungarian Forint"},IDR:{show:!1,fullname:"Indonesian Rupiah"},ILS:{show:!1,fullname:"Israeli Shekel"},INR:{show:!1,fullname:"Indian Rupee"},JPY:{show:!0,fullname:"Japanese Yen"},KRW:{show:!1,fullname:"South Korean Won"},MXN:{show:!1,fullname:"Mexican Peso"},MYR:{show:!1,fullname:"Malaysian Ringgit"},NOK:{show:!1,fullname:"Norwegian Krone"},NZD:{show:!1,fullname:"New Zealand Dollar"},PHP:{show:!1,fullname:"Philippine Peso"},PLN:{show:!1,fullname:"Polish Zloty"},RON:{show:!1,fullname:"Romanian New Leu"},RUB:{show:!1,fullname:"Russian Ruble"},SEK:{show:!1,fullname:"Swedish Krona"},SGD:{show:!1,fullname:"Singapore Dollar"},THB:{show:!1,fullname:"Thai Baht"},TRY:{show:!1,fullname:"Turkish Lira"},USD:{show:!0,fullname:"US Dollar"},ZAR:{show:!1,fullname:"South African Rand"}};var c={AUD:1.3102,BGN:1.8133,BRL:3.1159,CAD:1.3339,CHF:.99203,CNY:6.8856,CZK:25.052,DKK:6.8938,GBP:.79986,HKD:7.7675,HRK:6.8772,HUF:286.69,IDR:13317,ILS:3.6457,INR:65.464,JPY:110.66,KRW:1119.4,MXN:19.095,MYR:4.429,NOK:8.4812,NZD:1.4188,PHP:50.351,PLN:3.9574,RON:4.2235,RUB:57.667,SEK:8.8165,SGD:1.3987,THB:34.6,TRY:3.6193,ZAR:12.51,EUR:.92713};e.exchangeRateLastUpdated=new Date(Date.UTC(2017,2,23,15,0,0)),e.valueChange=function(n,t){100*n%1!==0&&(e.currenciesModel[t]=((1e3*n).toFixed(0)-(1e3*n).toFixed(0)%10)/1e3),h(t)};var h=function(n){var t=e.currenciesModel[n];for(var a in e.currenciesModel)e.currenciesModel[a]=s(i(n,a,t),2)};e.resetInputs=function(){for(var n in e.currenciesModel)e.currenciesModel[n]=null},e.show=function(){t.show({template:'<ion-spinner icon="dots" class="spinner-light"></ion-spinner>'})},e.hide=function(){t.hide()},e.getExchangeRates=function(){e.show(t);var l="https://api.fixer.io/latest?base=USD&"+(new Date).getTime();n.get(l,{timeout:5e3}).then(function(n){var t=n.data;c=t.rates;var a=function(e){var n=e.split("-");return new Date(Date.UTC(n[0],n[1]-1,n[2],15))};e.exchangeRateLastUpdated=a(t.date)},function(n){a.alert({title:"Error!",template:"Failed to get newest rates. Using rates from "+e.exchangeRateLastUpdated})}).finally(function(n){c.USD=1,e.hide(n)})};var d=function(){var n=l.get("currencies");n&&(e.currencies=n)};e.updateCurrenciesToShow=function(){l.set("currencies",e.currencies)},e.getExchangeRates(),d(),o(),e.settingsMenuOpen=!1,document.getElementById("main-content-styles").addEventListener("click",function(){r()<767&&e.settingsMenuOpen&&e.toggleSettingsMenu()}),e.toggleSettingsMenu=function(){e.settingsMenuOpen?(document.getElementById("settings-side-menu").style.width="0",document.getElementById("main-content-styles").style.width="100%",document.getElementById("settings-icon").classList.remove("menu-open"),e.settingsMenuOpen=!1):(r()>767?(document.getElementById("settings-side-menu").style.width="330px",document.getElementById("main-content-styles").style.width="calc(100% - 330px)"):document.getElementById("settings-side-menu").style.width="300px",document.getElementById("settings-icon").classList.add("menu-open"),e.settingsMenuOpen=!0)}}]);